<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>فرم رزرو</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* استایل‌ها بدون تغییر باقی می‌مانند */
        body { font-family: sans-serif; padding: 20px; color: var(--tg-theme-text-color); background: var(--tg-theme-bg-color); }
        input, select { width: 100%; padding: 10px; margin-bottom: 15px; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; }
        button { width: 100%; padding: 15px; background-color: var(--tg-theme-button-color); color: var(--tg-theme-button-text-color); border: none; border-radius: 5px; cursor: pointer; margin-top: 10px; }
        #confirmation-view { text-align: center; }
        #confirmation-view h3 { color: #4CAF50; }
    </style>
</head>
<body>

    <div id="form-view">
        <h3>فرم ثبت رزرو</h3>
        <form id="booking-form">
            <label for="name">نام کامل:</label>
            <input type="text" id="name" name="name" required>

            <label for="phone">شماره تماس:</label>
            <input type="tel" id="phone" name="phone" required>

            <label for="service">خدمت مورد نظر:</label>
            <input type="text" id="service" name="service" required>
        </form>
        <button id="submit-btn">آماده‌سازی پیام برای ارسال</button>
    </div>

    <div id="confirmation-view" style="display: none;">
        <h3>✅ پیام شما آماده شد!</h3>
        <p>لطفاً به صفحه‌ی چت برگشته و دکمه ارسال را بزنید.</p>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready();

        const submitBtn = document.getElementById('submit-btn');
        const formView = document.getElementById('form-view');
        const confirmationView = document.getElementById('confirmation-view');
        
        // وقتی کاربر دکمه ارسال را می‌زند
        submitBtn.addEventListener('click', function() {
            // ۱. خواندن اطلاعات از فیلدها
            let name = document.getElementById('name').value;
            let phone = document.getElementById('phone').value;
            let service = document.getElementById('service').value;

            // ۲. اعتبارسنجی
            if (!name || !phone || !service) {
                tg.showAlert('لطفا تمام فیلدها را پر کنید.');
                return;
            }

            // ۳. **بخش کلیدی جدید: ساخت پیام متنی**
            // ما یک پیام چند خطی با یک کلیدواژه مشخص در ابتدا می‌سازیم
            const messageText = `رزرو جدید:
نام: ${name}
شماره تماس: ${phone}
خدمت: ${service}`;
            
            // ۴. نمایش پیام تایید و بستن فرم
            formView.style.display = 'none';
            confirmationView.style.display = 'block';

            // ۵. **مهمترین بخش: جابجایی به چت و قرار دادن پیام در کادر متن**
            // این تابع متن آماده شده را در کادر متن کاربر قرار می‌دهد.
            tg.switchInlineQuery(messageText, []);
        });
    </script>
</body>
</html>
